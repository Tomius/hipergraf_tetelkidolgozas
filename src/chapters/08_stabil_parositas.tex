\chapter{Stabil párosítás fogalma, Gale-Shapley tétel}

Legyen adott egy $V$ csúcshalmaz, és $\forall x, y \in V$-re egy $f(x, y) = k$ függvény (preferencia lista), ahol $k$ nem negatív szám, és azt adja meg, hogy az $x$ csúcs ``mennyire preferálja'' az $xy$ élet (ha ez nulla, akkor $xy$ él nem választható be a párosításba).

\medskip

Egy $V$ feletti párosítás esetén $\forall x \in V$-re definiáljunk egy $g(x)$ értéket, ami azt adja meg, hogy $x$ mennyire ``örül'' a jelenlegi párjának, vagyis ha a párosításban $xy$ él, akkor $g(x) = f(x, y)$, ha $x$-ből nem megy él, akkor pedig $g(x) = 0$.

\medskip

Egy párosítás \emph{instabil}, ha $\exists x,y: f(x,y) > g(x)$ és $f(y, x) > g(y)$, azaz létezik olyan, a párosításban nem szereplő él, amit mindkét végpont jobban preferálna, mint a párosításbeli éleiket. Ha egy párosítás nem instabil, akkor azt mondjuk rá, hogy az egy \emph{stabil párosítás}.

\begin{thm}
  Ha $\GG$ nem páros gráf, akkor $\exists$ preferencia lista gyűjtemény, hogy $\not \exists$ stabil párosítás.
\end{thm}

Biz: Vegyünk egy páratlan kört a gráfban, és ebben állítsuk be a preferenciákat ``kő-papír-olló szerűen'', azaz egy felrajzolásban pl mindenki a tőle jobbra lévővel akarjon párt alkotni. Bármelyik párosításban lesz olyan csúcs, aminek nincs éle ebből a körből, ezt a csúcsot a tőle balra lévővel összekötő él instabillá teszi a párosítást.

\begin{thm} Gale-Shapley tétel:
  Ha $\GG$ páros gráf, akkor mindig $\exists$ benne stabil párosítás.
\end{thm}

Algoritmus:
\begin{itemize}
  \item A két osztályt a páros gráfban nevezzük fiúknak és lányoknak.
  \item A fiúk a listájukban a legjobban preferáltnak tesznek ajánlatot
  \item A lányok a legjobbnak azt mondják, hogy még várjanak, a többieket elutasítják
  \item Az elutasított fiúk új ajánlatokat tesznek. Ha mindnek üres a listája, akkor az algoritmus leáll, és az el nem utasított (várakozó) kérések alkotják a párosítást.
\end{itemize}

\begin{prop}
  Az algoritmus eredményeként nem jöhet létre instabil élt tartalmazó párosítás.
\end{prop}
Ha ugyanis $f$ és $l$ között lenne ilyen él, akkor $f$ hamarabb küldött volna ajánlatot $l$-nek, mint a jelenlegi párjának, és $l$ ezt nem utasította vissza, mert $f$-en kívül, csak számára az $f$-nél kevésbé preferált fiúk tettek neki ajánlatot, hiszen $f$-et jobban preferálja, mint a jelenlegi párját.

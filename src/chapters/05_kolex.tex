\chapter{Kolexikografikus rendezés. Pozitív egészek felírása r-binomiális alakban, a felírás egyértelműsége.}

% \begin{dfn} Egy halmazrendszer árnyéka:
%   $\partial \FF = \{B \in \binom{[n]}{r-1}: \exists F \in \FF, B \subseteq F\}$
% \end{dfn}

% Probléma: Ha $\FF \subseteq \binom{[n]}{r}$ és egy fix $m$-re $|\FF|=m$, akkor hogyan kell megválasztani $\FF$ elemeit, hogy $|\partial \FF|$ minimális legyen?

% \vspace{1em}

% Példa $n=8, r=3$ esetén olyan $\FF$-ekre, ahol $|\partial \FF|$ minimális:
% \begin{itemize}
%   \item $\left\{ \begin{aligned}
%     m &= 2 \\
%     \FF &= \{123, 234\} \hspace{2em} \left(\text{ami egy jelölés erre:} \{\{1,2,3\}, \{2,3,4\}\}\right) \\
%     \partial \FF &= \{12, 23, 13, 24, 34\}
%   \end{aligned} \right.$

%   \item $\left\{ \begin{aligned}
%     m &= 3 \\
%     \FF &= \{123, 234, 124\} \\
%     \partial \FF &= \{12, 23, 13, 24, 34, 14\}
%   \end{aligned} \right.$

%   \item $\left\{ \begin{aligned}
%     m &= 4 \\
%     \FF &= \{123, 234, 124, 134\} \\
%     \partial \FF &= \{12, 23, 13, 24, 34, 14\}
%   \end{aligned} \right.$

%   \item $\left\{ \begin{aligned}
%     m &= 5 \\
%     \FF &= \{123, 234, 124, 134, 125\} \\
%     \partial \FF &= \{12, 23, 13, 24, 34, 14, 15, 25\}
%   \end{aligned} \right.$

%   \item $\left\{ \begin{aligned}
%     m &= 6 \\
%     \FF &= \{123, 234, 124, 134, 125, 235\} \\
%     \partial \FF &= \{12, 23, 13, 24, 34, 14, 15, 25, 35\}
%   \end{aligned} \right.$

% \end{itemize}

% \begin{obs}
%   Az előbbi példa alapján kézenfekvőnek tűnik az a sejtés, hogy a $\binom{[n]}{r}$ halmazoknak létezik olyan sorrendje, hogy a sorrend első $m$ elemének az árnyéka minimális. A későbbiekben látni fogjuk, hogy ez a sejtés igaz.
% \end{obs}

Megjegyzés: A halmazok közötti sorrend értelmezéséhez azt feltételezzük, hogy a halmazok elemei egy halmazon belül balról-jobbra növekvő sorrendben vannak rendezve. Tehát például a $\{3, 5, 1\}$ halmazban az elemek belső sorrendjének az $1, 3, 5$ sorozatot értjük.

\vspace{1em}

\noindent A $\binom{[n]}{r}$ nevezetes sorrendjei közül kettő:
\begin{itemize}
  \item lexikografikus:\hphantom{ko} $\{a_1, a_2, ..., a_r\} < \{b_1, b_2, ..., b_r\}$, ha $\exists i: a_i < b_i$ és $\forall j < i: a_j = b_j$.

  Pl: $123, 124, 125, 126, 127, 128, 134, 135, 136, 137, 138, 145, 146, 147, 148, 156, \dots$

  \item kolexikografikus: $\{a_1, a_2, ..., a_r\} < \{b_1, b_2, ..., b_r\}$, ha $\exists i: a_i < b_i$ és $\forall j > i: a_j = b_j$.

  Pl: $123, 124, 134, 234, 125, 135, 235, 145, 245, 345, 126, 136, 236, 146, 246, 346, \dots$
\end{itemize}

A két sorrend közötti különbség, hogy a sorrendben a következő elem előállításhoz a lexikografikus rendezés a legjobboldali, azaz a legnagyobb elemet fogja növeli (ha az még nem érte el a maximális értékét), míg a kolexikografikus sorrend a legbaloldalibbat változtatja, azaz a legkisebb elemet, amit lehet növelni.

\medskip

Ebből fakadóan például a $\binom{[\infty]}{r}$ halmazok felsorolásánál a lexikografikus sorrend csak az utolsó számjegyet fogja növelni a végtelenségig. Ezzel szemben a kolexikografikus rendezés a $k$ nevű elemet csak akkor veszi be a halmazba, ha a $\binom{[k-1]}{r}$ összes halmazát már felsorolta, tehát már a $k-1$ a legkisebb elem, amit növelni tud új halmaz generáláshoz. Így a kolexikografikus rendezés a $\binom{[\infty]}{r}$ összes halmazát fel tudja sorolni, amit a lexikografikus rendezés erre nem képes.

\medskip

A kolexikografikus rendezésnek az a tulajdonsága, hogy a nagy elemeket a ``lehető legkésőbb'' használja csak fel, amikor a kisebb elemekből több halmazt nem tud már generálni, érdekessé teszi ezt a sorozatot az árnyék minimalizálás szempontjából.

\begin{thm}
  $\forall m, r \in \NN \exists m$-nek $r$-binomiális felírása:
  \[m = \binom{m_r}{r} + \binom{m_{r-1}}{r-1} + \dots + \binom{m_s}{s}\], ahol $m_r > m_{r-1} > \dots > m_s$(, az s értéke m-től és r-től függ), és ez a felírás egyértelmű.
\end{thm}

\begin{samepage} % TODO: ez miert nem mukodik?
  Biz: Ilyen felírást kapunk az alábbi módon: \\
  $m_r = max~\{k: \binom{k}{r} \leq m\}$ \\
  $m_{r-1} = max~\{k: \binom{k}{r-1} \leq m - \binom{m_r}{r}\}$ \\
  \vdots \\
  $m_j = max~\{k: \binom{k}{r-1} \leq \underbrace{m - \binom{m_r}{r} - \binom{m_{r-1}}{r-1} - \dots - \binom{m_{j+1}}{j+1}}_{d_{j+1}}\}$
\end{samepage}

Végül elérünk $d_s = 0$-hoz, hiszen ha $s=1$, akkor minden $d_s = m_s$ szám felírható $\binom{m_s}{s} = \binom{m_s}{1} = m_s$ alakban. Így kapunk egy felírást $m = \binom{m_r}{r} + \dots + \binom{m_s}{s}$ alakban, kell még, hogy erre $m_r > \dots > m_s$ teljesül.

\bigskip

Tegyük fel, hogy valamely j-re $m_j \geq m_{j+1}$. Ekkor $\binom{m_j}{j} \geq \binom{m_{j+1}}{j}$, ami átrendezhető arra az alakra, hogy $\underbrace{\binom{m_{j+1}}{j+1} + \binom{m_j}{j}}_{\geq d_{j+2}} \geq \binom{m_{j+1}}{j+1} + \binom{m_{j+1}}{j} = \binom{m_{j+1} + 1}{j+1}$ \Lightning. Ez azért ellentmondás, mert így $\binom{m_{j+1}+1}{j+1} \leq d_{j+2}$ miatt $m_{j+1}$ helyett választhattuk volna $(m_{j+1} + 1)$-et is. Tehát $m_r > \dots > m_s$ teljesül, a felírás létezik.

\bigskip

Kell még, hogy a felírás egyértelmű. Indirekt tegyük fel, hogy nem az, vagyis $\exists$ két ilyen felírása egy $m$ számnak: $m = \binom{m_r}{r} + \dots + \binom{m_s}{s}$, ahol $m_r > \dots > m_s$ és $m = \binom{m_r'}{r} + \dots + \binom{m_s'}{s}$, ahol $m_r' > \dots > m_s'$. Legyen $j$ a legnagyobb index, amire $m_j = m_j'$. Vagyis $d_{j+1}$-nek van két felírása, ahol az első tagok különböznek: $\binom{m_j}{j} + \binom{m_{j-1}}{j-1} + \dots + \binom{m_s}{s} = \overbrace{m - \binom{m_r}{r} - \dots - \binom{m_{j+1}}{j+1}}^{d_{j+1}} = m - \binom{m_r'}{r} - \dots - \binom{m_{j+1}''}{j+1} = \underbrace{\binom{m_j'}{j} + \binom{m_{j-1}'}{j-1} + \dots + \binom{m_s'}{s}}_{A}$.

\bigskip

WLOG (Without Loss Of Generality) tegyük fel, hogy $m_j > m_j'$. Ekkor $m_j' \leq m_j-1$, vagyis $A \leq \underbrace{\binom{m_j-1}{j} + \binom{m_j-2}{j-1} + \dots + \binom{m_j-j}{1}}_{B} < 1+B = \\ = \underbrace{1 + \binom{m_j-j}{1}}_{\binom{m_j-(j-1)}{1}} + \binom{m_j-(j-1)}{2} + \dots + \binom{m_j-1}{j} = \underbrace{\binom{m_j-(j-1)}{1} + \binom{m_j-(j-1)}{2}}_{\binom{m_j-(j-2)}{2}} + \dots + \binom{m_j-1}{j} = \binom{m_j}{j}$.

\bigskip

Vagyis $A = \binom{m_j}{j} + \binom{m_{j-1}}{j-1} + \dots + \binom{m_s}{s} < \binom{m_j}{j}$, ami ellentmondás \Lightning. Tehát a felírás egyértelmű.

\QED
